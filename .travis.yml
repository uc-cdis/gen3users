language: python
dist: xenial
python:
- '3.6'
install:
- pip install pipenv
- pipenv install --dev --deploy --python `which python`
- pip install -e git+https://git@github.com/uc-cdis/wool.git#egg=wool
script:
- if [[ $PR_NUMBER != false ]]; then GITHUB_TOKEN=$GH_TOKEN wool; fi
before_deploy:
- sed -i.bak "s/=get_version()/='$TRAVIS_TAG'/g" setup.py
- cat setup.py
- if [ $(python setup.py --version) == '0.0.0' ]; then travis_terminate 1; fi
deploy:
  provider: pypi
  user: uc-ctds
  skip_existing: true
  skip_cleanup: true
  on:
    tags: true
after_deploy:
- "./release_notes.sh"
env:
  matrix:
  - REPOSITORY="uc-cdis/gen3users" PR_NUMBER="$TRAVIS_PULL_REQUEST"
  global:
  - PIPENV_IGNORE_VIRTUALENVS=1
  - secure: WzD1fA+u5j3jQ1+13oH6syqch19lgusrOLmh+NgZ6l4Z/BlE0ZckDPkNGuYqtWtwdZSNQPhhT0d0drnn2ylS3KT5AvZIktTiO2ytQ04lNsEfd3syXildCuoo9Tx9YWCK8khKL9XU3ZqZIhnc0O5Hf/FGxmzJXQLq3zPOSFluxYvINdXr51YOhYOjuy7hyRRprcF9tTwDMv/Gc8/ogg/UOH+FAFp+ygAjoihJCpL9KhluBvUQWAIh8Es5r4dpCgVaQUL+4tffP/yMqrdP3MT+TqOuepTOz7NQvdboj86xCGleW9SO+3/W7cBGz/SLhQvJgLx6xiuMp1vDa0cblLsTDy9ZzraG0Z5o0SI8t36b/XgKg3gP13zYkb9KpcsevZ5H2tSTyKm0WLW4i4NTelTmH8T3SxtPP6hlvbfG4FEK5UGLt74PasH/gp6yjkqw6JX1fcEnPSkvPMjOH2q0wOyJn5tMzJ9uzRtn0oh6LfltkrROM1YcrCT91eGfnCh/PolN3n7IimwW+5vm+GlzrskrdY+wIx6Qr8m3qcIdo4YkRXzXYp6cuaobRLm9RsgrslhBtCrRYetzplPd1f8jnoACxk817Tb37+vZzZOXgvHyC+8SnHt2xWc/XwaKSmbfGm+baUTqvmjMHbhDZgHFe5GtEb/+8gwuGwdXsEJdUsuZzfo=
